{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\nhgiang\\\\Documents\\\\personal\\\\resonify\\\\frontend\\\\src\\\\components\\\\MapView.js\",\n  _s = $RefreshSig$(),\n  _s2 = $RefreshSig$(),\n  _s3 = $RefreshSig$();\n// src/components/MapView.js\nimport React, { useState, useEffect, useRef } from \"react\";\nimport { MapContainer, TileLayer, Marker, Popup, useMapEvents } from \"react-leaflet\";\nimport L from \"leaflet\";\nimport \"leaflet/dist/leaflet.css\";\n\n// Fix default icon path for React + Webpack (keeps default marker working if needed)\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\ndelete L.Icon.Default.prototype._getIconUrl;\nL.Icon.Default.mergeOptions({\n  iconRetinaUrl: require(\"leaflet/dist/images/marker-icon-2x.png\"),\n  iconUrl: require(\"leaflet/dist/images/marker-icon.png\"),\n  shadowUrl: require(\"leaflet/dist/images/marker-shadow.png\")\n});\n\n// Small helper: create a circle badge icon with number\nconst createCheckinIcon = count => L.divIcon({\n  html: `<div style=\"\n      position:relative;\n      background-color:#1976d2;\n      color:white;\n      border-radius:50%;\n      width:36px;\n      height:36px;\n      display:flex;\n      justify-content:center;\n      align-items:center;\n      font-weight:bold;\n      font-size:16px;\n      border:2px solid white;\n    \">${count}</div>`,\n  className: \"\",\n  iconSize: [36, 36],\n  iconAnchor: [18, 36],\n  popupAnchor: [0, -36]\n});\n\n// Aggregate concerts by level and compute average lat/lng (returns { key: { lat, lng, count, items, title } })\nconst aggregateConcerts = (concerts, level) => {\n  const grouped = {};\n  (concerts || []).forEach(c => {\n    // at city level group by exact coordinates so overlapping concerts share the same marker\n    const key = level === \"city\" ? `${c.lat},${c.lng}` : c[level] || \"Unknown\";\n    if (!grouped[key]) grouped[key] = {\n      latSum: 0,\n      lngSum: 0,\n      count: 0,\n      items: [],\n      title: \"\"\n    };\n    grouped[key].latSum += Number(c.lat || 0);\n    grouped[key].lngSum += Number(c.lng || 0);\n    grouped[key].count += 1;\n    grouped[key].items.push(c);\n    // set a friendly title to show in popups\n    grouped[key].title = level === \"city\" ? c.city : level === \"country\" ? c.country : c.continent;\n  });\n  Object.keys(grouped).forEach(k => {\n    grouped[k].lat = grouped[k].latSum / grouped[k].count || 0;\n    grouped[k].lng = grouped[k].lngSum / grouped[k].count || 0;\n  });\n  return grouped;\n};\n\n// ZoomHandler: listens for user zooms and updates aggregation level accordingly\nconst ZoomHandler = ({\n  setZoomLevel\n}) => {\n  _s();\n  useMapEvents({\n    zoomend: e => {\n      const z = e.target.getZoom();\n      if (z < 3) setZoomLevel(\"continent\");else if (z < 6) setZoomLevel(\"country\");else setZoomLevel(\"city\");\n    }\n  });\n  return null;\n};\n\n// ConcertGallery: shows a single-concert \"page\" + thumbnails + prev/next controls\n_s(ZoomHandler, \"Ld/tk8Iz8AdZhC1l7acENaOEoCo=\", false, function () {\n  return [useMapEvents];\n});\n_c = ZoomHandler;\nfunction ConcertGallery({\n  items\n}) {\n  _s2();\n  var _concert$artists;\n  // items: array of concert objects for this marker (usually 1+, may be duplicates at same coords)\n  const [index, setIndex] = useState(0); // which concert\n  const [photoIndex, setPhotoIndex] = useState(0); // which photo of the concert\n  useEffect(() => {\n    // reset when items change (open new popup / different location)\n    setIndex(0);\n    setPhotoIndex(0);\n  }, [items]);\n\n  // Keyboard left/right navigation while popup is open\n  useEffect(() => {\n    const onKey = e => {\n      if (e.key === \"ArrowLeft\") setIndex(i => Math.max(0, i - 1));\n      if (e.key === \"ArrowRight\") setIndex(i => Math.min(items.length - 1, i + 1));\n    };\n    window.addEventListener(\"keydown\", onKey);\n    return () => window.removeEventListener(\"keydown\", onKey);\n  }, [items.length]);\n  if (!items || items.length === 0) return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: \"No concerts\"\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 103,\n    columnNumber: 44\n  }, this);\n  const concert = items[index];\n  const photos = concert.photos || [];\n  const mainPhoto = photos[photoIndex] || photos[0] || null;\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    style: {\n      width: 360\n    },\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        display: \"flex\",\n        alignItems: \"center\",\n        justifyContent: \"space-between\",\n        marginBottom: 8\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: () => setIndex(i => Math.max(0, i - 1)),\n        disabled: index === 0,\n        \"aria-label\": \"Previous concert\",\n        children: \"\\u25C0\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 113,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          textAlign: \"center\",\n          flex: 1,\n          margin: \"0 8px\"\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            fontWeight: \"700\"\n          },\n          children: concert.name\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 122,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            fontSize: 12,\n            color: \"#555\"\n          },\n          children: [concert.date, \" \\u2014 \", concert.city, \", \", concert.country]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 123,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            fontSize: 12,\n            color: \"#777\"\n          },\n          children: [index + 1, \" / \", items.length]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 124,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 121,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: () => setIndex(i => Math.min(items.length - 1, i + 1)),\n        disabled: index === items.length - 1,\n        \"aria-label\": \"Next concert\",\n        children: \"\\u25B6\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 127,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 112,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        textAlign: \"center\",\n        marginBottom: 8\n      },\n      children: mainPhoto ? /*#__PURE__*/_jsxDEV(\"img\", {\n        src: mainPhoto,\n        alt: concert.name,\n        style: {\n          width: \"100%\",\n          height: 200,\n          objectFit: \"cover\",\n          borderRadius: 8\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 139,\n        columnNumber: 11\n      }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          width: \"100%\",\n          height: 200,\n          background: \"#eee\",\n          display: \"flex\",\n          alignItems: \"center\",\n          justifyContent: \"center\",\n          borderRadius: 8\n        },\n        children: \"No photo\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 145,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 137,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        display: \"flex\",\n        gap: 6,\n        overflowX: \"auto\",\n        marginBottom: 8\n      },\n      children: photos.map((p, i) => /*#__PURE__*/_jsxDEV(\"img\", {\n        src: p,\n        alt: `thumb-${i}`,\n        onClick: () => setPhotoIndex(i),\n        style: {\n          width: 60,\n          height: 40,\n          objectFit: \"cover\",\n          borderRadius: 6,\n          cursor: \"pointer\",\n          border: i === photoIndex ? \"2px solid #1976d2\" : \"1px solid #ddd\"\n        }\n      }, p + i, false, {\n        fileName: _jsxFileName,\n        lineNumber: 154,\n        columnNumber: 11\n      }, this))\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 152,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        fontSize: 13,\n        color: \"#333\"\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          marginBottom: 6\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n          children: \"Artists:\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 173,\n          columnNumber: 42\n        }, this), \" \", (_concert$artists = concert.artists) === null || _concert$artists === void 0 ? void 0 : _concert$artists.join(\", \")]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 173,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          marginBottom: 6\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n          children: \"Ticket:\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 174,\n          columnNumber: 42\n        }, this), \" \", concert.ticket]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 174,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          marginBottom: 6\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n          children: \"Venue coords:\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 175,\n          columnNumber: 42\n        }, this), \" \", concert.lat, \", \", concert.lng]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 175,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 172,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        marginTop: 8,\n        display: \"flex\",\n        justifyContent: \"space-between\"\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: () => {\n          setIndex(0);\n          setPhotoIndex(0);\n        },\n        children: \"First\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 180,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"a\", {\n        href: photos[photoIndex] || \"#\",\n        target: \"_blank\",\n        rel: \"noreferrer\",\n        style: {\n          alignSelf: \"center\",\n          fontSize: 13\n        },\n        children: \"Open photo\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 181,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 179,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 110,\n    columnNumber: 5\n  }, this);\n}\n_s2(ConcertGallery, \"cOIC9HMJMiU5ArqoI9LOS9norUc=\");\n_c2 = ConcertGallery;\nexport default function MapView() {\n  _s3();\n  const [concerts, setConcerts] = useState([]);\n  const [zoomLevel, setZoomLevel] = useState(\"continent\"); // continent | country | city\n  const mapRef = useRef(null);\n\n  // fly trigger so we call flyTo at a controlled time\n  const [flyToTarget, setFlyToTarget] = useState(null);\n  useEffect(() => {\n    fetch(\"http://localhost:8080/api/concerts\").then(res => res.json()).then(data => setConcerts(data || [])).catch(console.error);\n  }, []);\n\n  // when flyToTarget is set, call map.flyTo once\n  useEffect(() => {\n    if (flyToTarget && mapRef.current) {\n      mapRef.current.flyTo([flyToTarget.lat, flyToTarget.lng], flyToTarget.zoom, {\n        duration: 1.0\n      });\n      setFlyToTarget(null);\n    }\n  }, [flyToTarget]);\n\n  // compute aggregated markers for current level\n  const aggregated = aggregateConcerts(concerts, zoomLevel);\n\n  // handle click on higher-level marker: zoom/fly to next level (no popup)\n  const handleHigherLevelClick = items => {\n    const nextLevel = zoomLevel === \"continent\" ? \"country\" : zoomLevel === \"country\" ? \"city\" : \"city\";\n    const zoomMapping = {\n      continent: 2,\n      country: 5,\n      city: 9\n    }; // feel free to tweak\n    const first = items[0];\n    // update aggregation level (so after fly completes the markers reflect new level)\n    setZoomLevel(nextLevel);\n    setFlyToTarget({\n      lat: first.lat,\n      lng: first.lng,\n      zoom: zoomMapping[nextLevel]\n    });\n  };\n  return /*#__PURE__*/_jsxDEV(MapContainer, {\n    center: [20, 0],\n    zoom: 2,\n    style: {\n      height: \"100vh\",\n      width: \"100%\"\n    },\n    whenCreated: map => {\n      mapRef.current = map;\n    },\n    children: [/*#__PURE__*/_jsxDEV(TileLayer, {\n      url: \"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png\",\n      attribution: \"\\xA9 OpenStreetMap contributors\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 232,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(ZoomHandler, {\n      setZoomLevel: setZoomLevel\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 238,\n      columnNumber: 7\n    }, this), Object.entries(aggregated).map(([key, val]) => {\n      const {\n        lat,\n        lng,\n        count,\n        items,\n        title\n      } = val;\n      // On higher levels we want click to trigger fly (no popup).\n      // On city level we render a Popup containing the ConcertGallery.\n      const isCityLevel = zoomLevel === \"city\";\n      return /*#__PURE__*/_jsxDEV(Marker, {\n        position: [lat, lng],\n        icon: createCheckinIcon(count)\n        // only attach click handler for higher levels (continent/country)\n        ,\n        eventHandlers: isCityLevel ? undefined : {\n          click: () => handleHigherLevelClick(items)\n        },\n        children: isCityLevel && /*#__PURE__*/_jsxDEV(Popup, {\n          minWidth: 360,\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              maxWidth: 360\n            },\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              style: {\n                marginBottom: 8,\n                fontSize: 14,\n                fontWeight: 700\n              },\n              children: title\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 258,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(ConcertGallery, {\n              items: items\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 259,\n              columnNumber: 19\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 257,\n            columnNumber: 17\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 256,\n          columnNumber: 15\n        }, this)\n      }, key, false, {\n        fileName: _jsxFileName,\n        lineNumber: 248,\n        columnNumber: 11\n      }, this);\n    })]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 226,\n    columnNumber: 5\n  }, this);\n}\n_s3(MapView, \"P9j5vGQQbrL6MGu/QeCW4eD6vjA=\");\n_c3 = MapView;\nvar _c, _c2, _c3;\n$RefreshReg$(_c, \"ZoomHandler\");\n$RefreshReg$(_c2, \"ConcertGallery\");\n$RefreshReg$(_c3, \"MapView\");","map":{"version":3,"names":["React","useState","useEffect","useRef","MapContainer","TileLayer","Marker","Popup","useMapEvents","L","jsxDEV","_jsxDEV","Icon","Default","prototype","_getIconUrl","mergeOptions","iconRetinaUrl","require","iconUrl","shadowUrl","createCheckinIcon","count","divIcon","html","className","iconSize","iconAnchor","popupAnchor","aggregateConcerts","concerts","level","grouped","forEach","c","key","lat","lng","latSum","lngSum","items","title","Number","push","city","country","continent","Object","keys","k","ZoomHandler","setZoomLevel","_s","zoomend","e","z","target","getZoom","_c","ConcertGallery","_s2","_concert$artists","index","setIndex","photoIndex","setPhotoIndex","onKey","i","Math","max","min","length","window","addEventListener","removeEventListener","children","fileName","_jsxFileName","lineNumber","columnNumber","concert","photos","mainPhoto","style","width","display","alignItems","justifyContent","marginBottom","onClick","disabled","textAlign","flex","margin","fontWeight","name","fontSize","color","date","src","alt","height","objectFit","borderRadius","background","gap","overflowX","map","p","cursor","border","artists","join","ticket","marginTop","href","rel","alignSelf","_c2","MapView","_s3","setConcerts","zoomLevel","mapRef","flyToTarget","setFlyToTarget","fetch","then","res","json","data","catch","console","error","current","flyTo","zoom","duration","aggregated","handleHigherLevelClick","nextLevel","zoomMapping","first","center","whenCreated","url","attribution","entries","val","isCityLevel","position","icon","eventHandlers","undefined","click","minWidth","maxWidth","_c3","$RefreshReg$"],"sources":["C:/Users/nhgiang/Documents/personal/resonify/frontend/src/components/MapView.js"],"sourcesContent":["// src/components/MapView.js\r\nimport React, { useState, useEffect, useRef } from \"react\";\r\nimport {\r\n  MapContainer,\r\n  TileLayer,\r\n  Marker,\r\n  Popup,\r\n  useMapEvents,\r\n} from \"react-leaflet\";\r\nimport L from \"leaflet\";\r\nimport \"leaflet/dist/leaflet.css\";\r\n\r\n// Fix default icon path for React + Webpack (keeps default marker working if needed)\r\ndelete L.Icon.Default.prototype._getIconUrl;\r\nL.Icon.Default.mergeOptions({\r\n  iconRetinaUrl: require(\"leaflet/dist/images/marker-icon-2x.png\"),\r\n  iconUrl: require(\"leaflet/dist/images/marker-icon.png\"),\r\n  shadowUrl: require(\"leaflet/dist/images/marker-shadow.png\"),\r\n});\r\n\r\n// Small helper: create a circle badge icon with number\r\nconst createCheckinIcon = (count) =>\r\n  L.divIcon({\r\n    html: `<div style=\"\r\n      position:relative;\r\n      background-color:#1976d2;\r\n      color:white;\r\n      border-radius:50%;\r\n      width:36px;\r\n      height:36px;\r\n      display:flex;\r\n      justify-content:center;\r\n      align-items:center;\r\n      font-weight:bold;\r\n      font-size:16px;\r\n      border:2px solid white;\r\n    \">${count}</div>`,\r\n    className: \"\",\r\n    iconSize: [36, 36],\r\n    iconAnchor: [18, 36],\r\n    popupAnchor: [0, -36],\r\n  });\r\n\r\n// Aggregate concerts by level and compute average lat/lng (returns { key: { lat, lng, count, items, title } })\r\nconst aggregateConcerts = (concerts, level) => {\r\n  const grouped = {};\r\n  (concerts || []).forEach((c) => {\r\n    // at city level group by exact coordinates so overlapping concerts share the same marker\r\n    const key = level === \"city\" ? `${c.lat},${c.lng}` : c[level] || \"Unknown\";\r\n\r\n    if (!grouped[key]) grouped[key] = { latSum: 0, lngSum: 0, count: 0, items: [], title: \"\" };\r\n\r\n    grouped[key].latSum += Number(c.lat || 0);\r\n    grouped[key].lngSum += Number(c.lng || 0);\r\n    grouped[key].count += 1;\r\n    grouped[key].items.push(c);\r\n    // set a friendly title to show in popups\r\n    grouped[key].title = level === \"city\" ? c.city : level === \"country\" ? c.country : c.continent;\r\n  });\r\n\r\n  Object.keys(grouped).forEach((k) => {\r\n    grouped[k].lat = grouped[k].latSum / grouped[k].count || 0;\r\n    grouped[k].lng = grouped[k].lngSum / grouped[k].count || 0;\r\n  });\r\n\r\n  return grouped;\r\n};\r\n\r\n// ZoomHandler: listens for user zooms and updates aggregation level accordingly\r\nconst ZoomHandler = ({ setZoomLevel }) => {\r\n  useMapEvents({\r\n    zoomend: (e) => {\r\n      const z = e.target.getZoom();\r\n      if (z < 3) setZoomLevel(\"continent\");\r\n      else if (z < 6) setZoomLevel(\"country\");\r\n      else setZoomLevel(\"city\");\r\n    },\r\n  });\r\n  return null;\r\n};\r\n\r\n// ConcertGallery: shows a single-concert \"page\" + thumbnails + prev/next controls\r\nfunction ConcertGallery({ items }) {\r\n  // items: array of concert objects for this marker (usually 1+, may be duplicates at same coords)\r\n  const [index, setIndex] = useState(0); // which concert\r\n  const [photoIndex, setPhotoIndex] = useState(0); // which photo of the concert\r\n  useEffect(() => {\r\n    // reset when items change (open new popup / different location)\r\n    setIndex(0);\r\n    setPhotoIndex(0);\r\n  }, [items]);\r\n\r\n  // Keyboard left/right navigation while popup is open\r\n  useEffect(() => {\r\n    const onKey = (e) => {\r\n      if (e.key === \"ArrowLeft\") setIndex((i) => Math.max(0, i - 1));\r\n      if (e.key === \"ArrowRight\") setIndex((i) => Math.min(items.length - 1, i + 1));\r\n    };\r\n    window.addEventListener(\"keydown\", onKey);\r\n    return () => window.removeEventListener(\"keydown\", onKey);\r\n  }, [items.length]);\r\n\r\n  if (!items || items.length === 0) return <div>No concerts</div>;\r\n\r\n  const concert = items[index];\r\n  const photos = concert.photos || [];\r\n  const mainPhoto = photos[photoIndex] || photos[0] || null;\r\n\r\n  return (\r\n    <div style={{ width: 360 }}>\r\n      {/* header with nav */}\r\n      <div style={{ display: \"flex\", alignItems: \"center\", justifyContent: \"space-between\", marginBottom: 8 }}>\r\n        <button\r\n          onClick={() => setIndex((i) => Math.max(0, i - 1))}\r\n          disabled={index === 0}\r\n          aria-label=\"Previous concert\"\r\n        >\r\n          ◀\r\n        </button>\r\n\r\n        <div style={{ textAlign: \"center\", flex: 1, margin: \"0 8px\" }}>\r\n          <div style={{ fontWeight: \"700\" }}>{concert.name}</div>\r\n          <div style={{ fontSize: 12, color: \"#555\" }}>{concert.date} — {concert.city}, {concert.country}</div>\r\n          <div style={{ fontSize: 12, color: \"#777\" }}>{index + 1} / {items.length}</div>\r\n        </div>\r\n\r\n        <button\r\n          onClick={() => setIndex((i) => Math.min(items.length - 1, i + 1))}\r\n          disabled={index === items.length - 1}\r\n          aria-label=\"Next concert\"\r\n        >\r\n          ▶\r\n        </button>\r\n      </div>\r\n\r\n      {/* main photo */}\r\n      <div style={{ textAlign: \"center\", marginBottom: 8 }}>\r\n        {mainPhoto ? (\r\n          <img\r\n            src={mainPhoto}\r\n            alt={concert.name}\r\n            style={{ width: \"100%\", height: 200, objectFit: \"cover\", borderRadius: 8 }}\r\n          />\r\n        ) : (\r\n          <div style={{ width: \"100%\", height: 200, background: \"#eee\", display: \"flex\", alignItems: \"center\", justifyContent: \"center\", borderRadius: 8 }}>\r\n            No photo\r\n          </div>\r\n        )}\r\n      </div>\r\n\r\n      {/* thumbnail row (photos of current concert) */}\r\n      <div style={{ display: \"flex\", gap: 6, overflowX: \"auto\", marginBottom: 8 }}>\r\n        {photos.map((p, i) => (\r\n          <img\r\n            key={p + i}\r\n            src={p}\r\n            alt={`thumb-${i}`}\r\n            onClick={() => setPhotoIndex(i)}\r\n            style={{\r\n              width: 60,\r\n              height: 40,\r\n              objectFit: \"cover\",\r\n              borderRadius: 6,\r\n              cursor: \"pointer\",\r\n              border: i === photoIndex ? \"2px solid #1976d2\" : \"1px solid #ddd\",\r\n            }}\r\n          />\r\n        ))}\r\n      </div>\r\n\r\n      {/* details */}\r\n      <div style={{ fontSize: 13, color: \"#333\" }}>\r\n        <div style={{ marginBottom: 6 }}><strong>Artists:</strong> {concert.artists?.join(\", \")}</div>\r\n        <div style={{ marginBottom: 6 }}><strong>Ticket:</strong> {concert.ticket}</div>\r\n        <div style={{ marginBottom: 6 }}><strong>Venue coords:</strong> {concert.lat}, {concert.lng}</div>\r\n      </div>\r\n\r\n      {/* small actions */}\r\n      <div style={{ marginTop: 8, display: \"flex\", justifyContent: \"space-between\" }}>\r\n        <button onClick={() => { setIndex(0); setPhotoIndex(0); }}>First</button>\r\n        <a href={photos[photoIndex] || \"#\"} target=\"_blank\" rel=\"noreferrer\" style={{ alignSelf: \"center\", fontSize: 13 }}>\r\n          Open photo\r\n        </a>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default function MapView() {\r\n  const [concerts, setConcerts] = useState([]);\r\n  const [zoomLevel, setZoomLevel] = useState(\"continent\"); // continent | country | city\r\n  const mapRef = useRef(null);\r\n\r\n  // fly trigger so we call flyTo at a controlled time\r\n  const [flyToTarget, setFlyToTarget] = useState(null);\r\n\r\n  useEffect(() => {\r\n    fetch(\"http://localhost:8080/api/concerts\")\r\n      .then((res) => res.json())\r\n      .then((data) => setConcerts(data || []))\r\n      .catch(console.error);\r\n  }, []);\r\n\r\n  // when flyToTarget is set, call map.flyTo once\r\n  useEffect(() => {\r\n    if (flyToTarget && mapRef.current) {\r\n      mapRef.current.flyTo([flyToTarget.lat, flyToTarget.lng], flyToTarget.zoom, { duration: 1.0 });\r\n      setFlyToTarget(null);\r\n    }\r\n  }, [flyToTarget]);\r\n\r\n  // compute aggregated markers for current level\r\n  const aggregated = aggregateConcerts(concerts, zoomLevel);\r\n\r\n  // handle click on higher-level marker: zoom/fly to next level (no popup)\r\n  const handleHigherLevelClick = (items) => {\r\n    const nextLevel = zoomLevel === \"continent\" ? \"country\" : zoomLevel === \"country\" ? \"city\" : \"city\";\r\n    const zoomMapping = { continent: 2, country: 5, city: 9 }; // feel free to tweak\r\n    const first = items[0];\r\n    // update aggregation level (so after fly completes the markers reflect new level)\r\n    setZoomLevel(nextLevel);\r\n    setFlyToTarget({ lat: first.lat, lng: first.lng, zoom: zoomMapping[nextLevel] });\r\n  };\r\n\r\n  return (\r\n    <MapContainer\r\n      center={[20, 0]}\r\n      zoom={2}\r\n      style={{ height: \"100vh\", width: \"100%\" }}\r\n      whenCreated={(map) => { mapRef.current = map; }}\r\n    >\r\n      <TileLayer\r\n        url=\"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png\"\r\n        attribution=\"&copy; OpenStreetMap contributors\"\r\n      />\r\n\r\n      {/* Listen for manual zoom changes so pins merge/split when user zooms in/out */}\r\n      <ZoomHandler setZoomLevel={setZoomLevel} />\r\n\r\n      {/* Render aggregated markers */}\r\n      {Object.entries(aggregated).map(([key, val]) => {\r\n        const { lat, lng, count, items, title } = val;\r\n        // On higher levels we want click to trigger fly (no popup).\r\n        // On city level we render a Popup containing the ConcertGallery.\r\n        const isCityLevel = zoomLevel === \"city\";\r\n\r\n        return (\r\n          <Marker\r\n            key={key}\r\n            position={[lat, lng]}\r\n            icon={createCheckinIcon(count)}\r\n            // only attach click handler for higher levels (continent/country)\r\n            eventHandlers={isCityLevel ? undefined : { click: () => handleHigherLevelClick(items) }}\r\n          >\r\n            {isCityLevel && (\r\n              <Popup minWidth={360}>\r\n                <div style={{ maxWidth: 360 }}>\r\n                  <div style={{ marginBottom: 8, fontSize: 14, fontWeight: 700 }}>{title}</div>\r\n                  <ConcertGallery items={items} />\r\n                </div>\r\n              </Popup>\r\n            )}\r\n          </Marker>\r\n        );\r\n      })}\r\n    </MapContainer>\r\n  );\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}