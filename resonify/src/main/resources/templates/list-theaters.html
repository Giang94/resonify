<div th:fragment="content">
	<h1>All Theaters</h1>
	<table border="1" cellpadding="5">
		<tr>
			<th>ID</th>
			<th>Name</th>
			<th>Address</th>
			<th>Lat</th>
			<th>Lng</th>
			<th>City</th>
			<th>Photo</th>
			<th>Actions</th>
		</tr>
		<tr th:each="t : ${theaters}">
			<form th:action="@{/web/theaters/{id}(id=${t.id})}" method="post">
				<input type="hidden" name="_method" value="put"/>
				<td th:text="${t.id}"></td>
				<td><input type="text" name="name" th:value="${t.name}"/></td>
				<td><input type="text" name="address" th:value="${t.address}"/></td>
				<td><input type="number" step="any" name="lat" th:value="${t.lat}"/></td>
				<td><input type="number" step="any" name="lng" th:value="${t.lng}"/></td>
				<td>
					<select name="cityId" class="searchable-select">
						<option th:each="c : ${cities}"
						        th:value="${c.id}"
						        th:text="${c.name}"
						        th:selected="${c.id == t.city.id}">
						</option>
					</select>
				</td>
				<td style="text-align:center;">
					<div class="photo-editor" style="display:flex; flex-direction:column; gap:6px; align-items:center;">
						<!-- Current photo preview -->
						<img th:if="${t.photo}" th:src="${t.photo}" class="photo-thumb"
						     style="width:80px; border-radius:4px;"/>
						
						<!-- Action icons below the thumbnail -->
						<div style="display:flex; gap:8px; align-items:center; justify-content:center;">
							<span class="photo-delete-btn" title="Delete"
							      style="cursor:pointer; color:red; font-weight:bold;">✖</span>
							<span class="photo-change-btn" title="Change" style="cursor:pointer;">✏️</span>
							<span class="photo-undo-btn" title="Undo" style="cursor:pointer; display:none;">↩️</span>
						</div>
						
						<!-- Input field for new URL -->
						<input type="text" class="photo-url-input" placeholder="Enter photo URL"
						       style="display:none; width:150px;"/>
						
						<!-- Hidden inputs to send backend info -->
						<input type="hidden" name="photoAction" class="photo-action-input" th:value="'KEEP'"/>
						<input type="hidden" name="photoUrl" class="photo-url-hidden" th:value="${t.photo}"/>
					</div>
				</td>
				
				
				<td>
					<button type="submit" style="background:none;border:none;cursor:pointer;font-size:18px;">💾</button>
					<form th:action="@{/web/theaters/{id}(id=${t.id})}" method="post" style="display:inline;">
						<input type="hidden" name="_method" value="delete"/>
						<button type="submit" title="Delete"
						        style="background:none;border:none;cursor:pointer;font-size:18px;"
						        onclick="return confirm('Are you sure you want to delete this theater?');">
							🗑️
						</button>
					</form>
				</td>
			</form>
		</tr>
	</table>
</div>